10 VII:

RXNORM: Name = ingredients, strengths, form.
It's a metathesaurus, gathering info from different drug records

There are Branded Packs: "{'quantity' (SCD1/SBD1) / 'quantity' (SCD2/SBD2) / 'quantity' (SCDn/SBDn) } Pack [Market Name]"

eg: {12 (Ethinyl Estradiol 0.035 MG / Norethindrone 0.5 MG Oral Tablet) / 9 (Ethinyl Estradiol 0.035 MG / Norethindrone 1 MG Oral Tablet) / 7 (Inert Ingredients 1 MG Oral Tablet) } Pack [Leena 28 Day] 

In RXNREL Branded Packs and Generic Packs are linked

now we get :

zostrix]) / 1 (28300 mg) (menthol 4 % topical cream [zostrix cold therapy]) } pack [zostrix hot and cold therapy system
zostrix]) / 1 (28300 mg) (menthol 40 mg/ml topical cream [zostrix cold therapy]) } pack [zostrix hot and cold therapy system

but we want multiple entries for that

now we just get the first: okay, fixed

> we're getting all the BPCK

RXNCONSO.RFF: one row for each unique RXAUI (RXCUI: unique concept identifier)
RXNREL: relationshis
RXNSAT: attributes



Thanks to the RXCUI, we can see:

639888 emtricitabine 200 MG / Tenofovir disoproxil fumarate 300 MG Oral Tablet [Truvada]
639888 Truvada (emtricitabine 200 MG / tenofovir disoproxil fumarate 300 MG (tenofovir disoproxil 245 MG) ) Oral Tablet
639888 emtricitabine 200 mg / tenofovir disoproxil fumarate 300 mg ORAL TABLET, FILM COATED [Truvada]
639888 EMTRICITABINE 200 mg / TENOFOVIR DISOPROXIL FUMARATE 300 mg ORAL TABLET, FILM COATED [Truvada]


let's find out: for all that have same ids


okay, we can do two things: longest common substring, and splitting smartly


these are all the same concept. But does this concept have a name?

3 VII: Last time, I also changed the zip function in fetch_remote
* hardcoded filenames into zip function
* changed DL function for easier testing

> This is all very ugly. Revert these changes, figure out the forking and make everything look nice and documented.

28 VI: DLing RX Norm - it's a zip file, so we can't stream. So far, I got it to DL and write the zip file, so the rest should be easier. However, I took the following short cuts that could later on blow up in my face:

* knocked out SSL downloading because NIH server did not like it
* knocked out Forking in fetch_input.py's zip method, because I don't 100% understand what it does: It's probably related to having multiple files; so if we want to make use of RX Norms full potential, I might just as well end up needing it.

The way how we write the zip file is not very elegant, it would be better to use sockets and write the file chunk by chunk.

Setup:
* change scratch path in settings and run make
* venv and install lxml
* To run: PYTHONPATH=.. python update/fetch_remote.py rxnorm
